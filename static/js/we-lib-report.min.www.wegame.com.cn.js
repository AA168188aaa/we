var WeLibReport=function(e){"use strict";
/*! *****************************************************************************
    Copyright (c) Microsoft Corporation.

    Permission to use, copy, modify, and/or distribute this software for any
    purpose with or without fee is hereby granted.

    THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
    REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
    AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
    INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
    LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
    OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
    PERFORMANCE OF THIS SOFTWARE.
    ***************************************************************************** */var t=function(){return(t=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};function n(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(r=Object.getOwnPropertySymbols(e);o<r.length;o++)t.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(e,r[o])&&(n[r[o]]=e[r[o]])}return n}var r="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},o=Object.prototype.hasOwnProperty,i=Array.isArray,s=function(){for(var e=[],t=0;t<256;++t)e.push("%"+((t<16?"0":"")+t.toString(16)).toUpperCase());return e}(),a=function(e,t){for(var n=t&&t.plainObjects?Object.create(null):{},r=0;r<e.length;++r)void 0!==e[r]&&(n[r]=e[r]);return n},c={arrayToObject:a,assign:function(e,t){return Object.keys(t).reduce((function(e,n){return e[n]=t[n],e}),e)},combine:function(e,t){return[].concat(e,t)},compact:function(e){for(var t=[{obj:{o:e},prop:"o"}],n=[],r=0;r<t.length;++r)for(var o=t[r],s=o.obj[o.prop],a=Object.keys(s),c=0;c<a.length;++c){var u=a[c],l=s[u];"object"==typeof l&&null!==l&&-1===n.indexOf(l)&&(t.push({obj:s,prop:u}),n.push(l))}return function(e){for(;e.length>1;){var t=e.pop(),n=t.obj[t.prop];if(i(n)){for(var r=[],o=0;o<n.length;++o)void 0!==n[o]&&r.push(n[o]);t.obj[t.prop]=r}}}(t),e},decode:function(e,t,n){var r=e.replace(/\+/g," ");if("iso-8859-1"===n)return r.replace(/%[0-9a-f]{2}/gi,unescape);try{return decodeURIComponent(r)}catch(e){return r}},encode:function(e,t,n){if(0===e.length)return e;var r=e;if("symbol"==typeof e?r=Symbol.prototype.toString.call(e):"string"!=typeof e&&(r=String(e)),"iso-8859-1"===n)return escape(r).replace(/%u[0-9a-f]{4}/gi,(function(e){return"%26%23"+parseInt(e.slice(2),16)+"%3B"}));for(var o="",i=0;i<r.length;++i){var a=r.charCodeAt(i);45===a||46===a||95===a||126===a||a>=48&&a<=57||a>=65&&a<=90||a>=97&&a<=122?o+=r.charAt(i):a<128?o+=s[a]:a<2048?o+=s[192|a>>6]+s[128|63&a]:a<55296||a>=57344?o+=s[224|a>>12]+s[128|a>>6&63]+s[128|63&a]:(i+=1,a=65536+((1023&a)<<10|1023&r.charCodeAt(i)),o+=s[240|a>>18]+s[128|a>>12&63]+s[128|a>>6&63]+s[128|63&a])}return o},isBuffer:function(e){return!(!e||"object"!=typeof e)&&!!(e.constructor&&e.constructor.isBuffer&&e.constructor.isBuffer(e))},isRegExp:function(e){return"[object RegExp]"===Object.prototype.toString.call(e)},merge:function e(t,n,r){if(!n)return t;if("object"!=typeof n){if(i(t))t.push(n);else{if(!t||"object"!=typeof t)return[t,n];(r&&(r.plainObjects||r.allowPrototypes)||!o.call(Object.prototype,n))&&(t[n]=!0)}return t}if(!t||"object"!=typeof t)return[t].concat(n);var s=t;return i(t)&&!i(n)&&(s=a(t,r)),i(t)&&i(n)?(n.forEach((function(n,i){if(o.call(t,i)){var s=t[i];s&&"object"==typeof s&&n&&"object"==typeof n?t[i]=e(s,n,r):t.push(n)}else t[i]=n})),t):Object.keys(n).reduce((function(t,i){var s=n[i];return o.call(t,i)?t[i]=e(t[i],s,r):t[i]=s,t}),s)}},u=String.prototype.replace,l=/%20/g,p={RFC1738:"RFC1738",RFC3986:"RFC3986"},f=c.assign({default:p.RFC3986,formatters:{RFC1738:function(e){return u.call(e,l,"+")},RFC3986:function(e){return String(e)}}},p),d=c,m=f,g=Object.prototype.hasOwnProperty,h={brackets:function(e){return e+"[]"},comma:"comma",indices:function(e,t){return e+"["+t+"]"},repeat:function(e){return e}},v=Array.isArray,y=Array.prototype.push,w=function(e,t){y.apply(e,v(t)?t:[t])},b=Date.prototype.toISOString,O=m.default,E={addQueryPrefix:!1,allowDots:!1,charset:"utf-8",charsetSentinel:!1,delimiter:"&",encode:!0,encoder:d.encode,encodeValuesOnly:!1,format:O,formatter:m.formatters[O],indices:!1,serializeDate:function(e){return b.call(e)},skipNulls:!1,strictNullHandling:!1},S=function e(t,n,r,o,i,s,a,c,u,l,p,f,m){var g,h=t;if("function"==typeof a?h=a(n,h):h instanceof Date?h=l(h):"comma"===r&&v(h)&&(h=h.join(",")),null===h){if(o)return s&&!f?s(n,E.encoder,m,"key"):n;h=""}if("string"==typeof(g=h)||"number"==typeof g||"boolean"==typeof g||"symbol"==typeof g||"bigint"==typeof g||d.isBuffer(h))return s?[p(f?n:s(n,E.encoder,m,"key"))+"="+p(s(h,E.encoder,m,"value"))]:[p(n)+"="+p(String(h))];var y,b=[];if(void 0===h)return b;if(v(a))y=a;else{var O=Object.keys(h);y=c?O.sort(c):O}for(var S=0;S<y.length;++S){var R=y[S];i&&null===h[R]||(v(h)?w(b,e(h[R],"function"==typeof r?r(n,R):n,r,o,i,s,a,c,u,l,p,f,m)):w(b,e(h[R],n+(u?"."+R:"["+R+"]"),r,o,i,s,a,c,u,l,p,f,m)))}return b},R=c,C=Object.prototype.hasOwnProperty,x=Array.isArray,I={allowDots:!1,allowPrototypes:!1,arrayLimit:20,charset:"utf-8",charsetSentinel:!1,comma:!1,decoder:R.decode,delimiter:"&",depth:5,ignoreQueryPrefix:!1,interpretNumericEntities:!1,parameterLimit:1e3,parseArrays:!0,plainObjects:!1,strictNullHandling:!1},T=function(e){return e.replace(/&#(\d+);/g,(function(e,t){return String.fromCharCode(parseInt(t,10))}))},L=function(e,t,n){if(e){var r=n.allowDots?e.replace(/\.([^.[]+)/g,"[$1]"):e,o=/(\[[^[\]]*])/g,i=n.depth>0&&/(\[[^[\]]*])/.exec(r),s=i?r.slice(0,i.index):r,a=[];if(s){if(!n.plainObjects&&C.call(Object.prototype,s)&&!n.allowPrototypes)return;a.push(s)}for(var c=0;n.depth>0&&null!==(i=o.exec(r))&&c<n.depth;){if(c+=1,!n.plainObjects&&C.call(Object.prototype,i[1].slice(1,-1))&&!n.allowPrototypes)return;a.push(i[1])}return i&&a.push("["+r.slice(i.index)+"]"),function(e,t,n){for(var r=t,o=e.length-1;o>=0;--o){var i,s=e[o];if("[]"===s&&n.parseArrays)i=[].concat(r);else{i=n.plainObjects?Object.create(null):{};var a="["===s.charAt(0)&&"]"===s.charAt(s.length-1)?s.slice(1,-1):s,c=parseInt(a,10);n.parseArrays||""!==a?!isNaN(c)&&s!==a&&String(c)===a&&c>=0&&n.parseArrays&&c<=n.arrayLimit?(i=[])[c]=r:i[a]=r:i={0:r}}r=i}return r}(a,t,n)}},N={formats:f,parse:function(e,t){var n=function(e){if(!e)return I;if(null!==e.decoder&&void 0!==e.decoder&&"function"!=typeof e.decoder)throw new TypeError("Decoder has to be a function.");if(void 0!==e.charset&&"utf-8"!==e.charset&&"iso-8859-1"!==e.charset)throw new Error("The charset option must be either utf-8, iso-8859-1, or undefined");var t=void 0===e.charset?I.charset:e.charset;return{allowDots:void 0===e.allowDots?I.allowDots:!!e.allowDots,allowPrototypes:"boolean"==typeof e.allowPrototypes?e.allowPrototypes:I.allowPrototypes,arrayLimit:"number"==typeof e.arrayLimit?e.arrayLimit:I.arrayLimit,charset:t,charsetSentinel:"boolean"==typeof e.charsetSentinel?e.charsetSentinel:I.charsetSentinel,comma:"boolean"==typeof e.comma?e.comma:I.comma,decoder:"function"==typeof e.decoder?e.decoder:I.decoder,delimiter:"string"==typeof e.delimiter||R.isRegExp(e.delimiter)?e.delimiter:I.delimiter,depth:"number"==typeof e.depth||!1===e.depth?+e.depth:I.depth,ignoreQueryPrefix:!0===e.ignoreQueryPrefix,interpretNumericEntities:"boolean"==typeof e.interpretNumericEntities?e.interpretNumericEntities:I.interpretNumericEntities,parameterLimit:"number"==typeof e.parameterLimit?e.parameterLimit:I.parameterLimit,parseArrays:!1!==e.parseArrays,plainObjects:"boolean"==typeof e.plainObjects?e.plainObjects:I.plainObjects,strictNullHandling:"boolean"==typeof e.strictNullHandling?e.strictNullHandling:I.strictNullHandling}}(t);if(""===e||null==e)return n.plainObjects?Object.create(null):{};for(var r="string"==typeof e?function(e,t){var n,r={},o=t.ignoreQueryPrefix?e.replace(/^\?/,""):e,i=t.parameterLimit===1/0?void 0:t.parameterLimit,s=o.split(t.delimiter,i),a=-1,c=t.charset;if(t.charsetSentinel)for(n=0;n<s.length;++n)0===s[n].indexOf("utf8=")&&("utf8=%E2%9C%93"===s[n]?c="utf-8":"utf8=%26%2310003%3B"===s[n]&&(c="iso-8859-1"),a=n,n=s.length);for(n=0;n<s.length;++n)if(n!==a){var u,l,p=s[n],f=p.indexOf("]="),d=-1===f?p.indexOf("="):f+1;-1===d?(u=t.decoder(p,I.decoder,c,"key"),l=t.strictNullHandling?null:""):(u=t.decoder(p.slice(0,d),I.decoder,c,"key"),l=t.decoder(p.slice(d+1),I.decoder,c,"value")),l&&t.interpretNumericEntities&&"iso-8859-1"===c&&(l=T(l)),l&&"string"==typeof l&&t.comma&&l.indexOf(",")>-1&&(l=l.split(",")),p.indexOf("[]=")>-1&&(l=x(l)?[l]:l),C.call(r,u)?r[u]=R.combine(r[u],l):r[u]=l}return r}(e,n):e,o=n.plainObjects?Object.create(null):{},i=Object.keys(r),s=0;s<i.length;++s){var a=i[s],c=L(a,r[a],n);o=R.merge(o,c,n)}return R.compact(o)},stringify:function(e,t){var n,r=e,o=function(e){if(!e)return E;if(null!==e.encoder&&void 0!==e.encoder&&"function"!=typeof e.encoder)throw new TypeError("Encoder has to be a function.");var t=e.charset||E.charset;if(void 0!==e.charset&&"utf-8"!==e.charset&&"iso-8859-1"!==e.charset)throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");var n=m.default;if(void 0!==e.format){if(!g.call(m.formatters,e.format))throw new TypeError("Unknown format option provided.");n=e.format}var r=m.formatters[n],o=E.filter;return("function"==typeof e.filter||v(e.filter))&&(o=e.filter),{addQueryPrefix:"boolean"==typeof e.addQueryPrefix?e.addQueryPrefix:E.addQueryPrefix,allowDots:void 0===e.allowDots?E.allowDots:!!e.allowDots,charset:t,charsetSentinel:"boolean"==typeof e.charsetSentinel?e.charsetSentinel:E.charsetSentinel,delimiter:void 0===e.delimiter?E.delimiter:e.delimiter,encode:"boolean"==typeof e.encode?e.encode:E.encode,encoder:"function"==typeof e.encoder?e.encoder:E.encoder,encodeValuesOnly:"boolean"==typeof e.encodeValuesOnly?e.encodeValuesOnly:E.encodeValuesOnly,filter:o,formatter:r,serializeDate:"function"==typeof e.serializeDate?e.serializeDate:E.serializeDate,skipNulls:"boolean"==typeof e.skipNulls?e.skipNulls:E.skipNulls,sort:"function"==typeof e.sort?e.sort:null,strictNullHandling:"boolean"==typeof e.strictNullHandling?e.strictNullHandling:E.strictNullHandling}}(t);"function"==typeof o.filter?r=(0,o.filter)("",r):v(o.filter)&&(n=o.filter);var i,s=[];if("object"!=typeof r||null===r)return"";i=t&&t.arrayFormat in h?t.arrayFormat:t&&"indices"in t?t.indices?"indices":"repeat":"indices";var a=h[i];n||(n=Object.keys(r)),o.sort&&n.sort(o.sort);for(var c=0;c<n.length;++c){var u=n[c];o.skipNulls&&null===r[u]||w(s,S(r[u],u,a,o.strictNullHandling,o.skipNulls,o.encode?o.encoder:null,o.filter,o.sort,o.allowDots,o.serializeDate,o.formatter,o.encodeValuesOnly,o.charset))}var l=s.join(o.delimiter),p=!0===o.addQueryPrefix?"?":"";return o.charsetSentinel&&("iso-8859-1"===o.charset?p+="utf8=%26%2310003%3B&":p+="utf8=%E2%9C%93&"),l.length>0?p+l:""}},A={exports:{}};A.exports=function(){function e(){for(var e=0,t={};e<arguments.length;e++){var n=arguments[e];for(var r in n)t[r]=n[r]}return t}function t(e){return e.replace(/(%[0-9A-Z]{2})+/g,decodeURIComponent)}return function n(r){function o(){}function i(t,n,i){if("undefined"!=typeof document){"number"==typeof(i=e({path:"/"},o.defaults,i)).expires&&(i.expires=new Date(1*new Date+864e5*i.expires)),i.expires=i.expires?i.expires.toUTCString():"";try{var s=JSON.stringify(n);/^[\{\[]/.test(s)&&(n=s)}catch(e){}n=r.write?r.write(n,t):encodeURIComponent(String(n)).replace(/%(23|24|26|2B|3A|3C|3E|3D|2F|3F|40|5B|5D|5E|60|7B|7D|7C)/g,decodeURIComponent),t=encodeURIComponent(String(t)).replace(/%(23|24|26|2B|5E|60|7C)/g,decodeURIComponent).replace(/[\(\)]/g,escape);var a="";for(var c in i)i[c]&&(a+="; "+c,!0!==i[c]&&(a+="="+i[c].split(";")[0]));return document.cookie=t+"="+n+a}}function s(e,n){if("undefined"!=typeof document){for(var o={},i=document.cookie?document.cookie.split("; "):[],s=0;s<i.length;s++){var a=i[s].split("="),c=a.slice(1).join("=");n||'"'!==c.charAt(0)||(c=c.slice(1,-1));try{var u=t(a[0]);if(c=(r.read||r)(c,u)||t(c),n)try{c=JSON.parse(c)}catch(e){}if(o[u]=c,e===u)break}catch(e){}}return e?o[e]:o}}return o.set=i,o.get=function(e){return s(e,!1)},o.getJSON=function(e){return s(e,!0)},o.remove=function(t,n){i(t,"",e(n,{expires:-1}))},o.defaults={},o.withConverter=n,o}((function(){}))}();var P=A.exports,j={};function _(){return e=P.get("uin")||P.get("pt2gguin")||P.get("uin_cookie")||"",String(e).replace(/^o0*/g,"")||"";var e}!function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.clientVersion=e.getClientVersion=e.pageHost=e.isWeGameX=e.isMainland=e.isOversea=e.isProduction=e.isPreRelease=e.isTest=e.isDevelopment=e.isTgpIndependent=e.isWeGameIndependent=e.isTgpCross=e.isWeGameCross=e.isTgpFrame=e.isWeGameFrame=e.isTgpMainTop=e.isWeGameMainTop=e.isTgpMain=e.isWeGameMain=e.isTgp=e.isWeGame=e.isInClient=e.isServer=e.isBrowser=void 0,e.isBrowser="undefined"!=typeof window&&"undefined"!=typeof document,e.isServer=!e.isBrowser&&void 0!==r;var t=function(e){try{return e()}catch(e){return!1}};e.isInClient=e.isBrowser&&window.external&&"function"==typeof window.external.callcpp&&t((function(){return window.top.location.href,!0})),e.isWeGame=e.isInClient,e.isTgp=e.isInClient,e.isWeGameMain=e.isWeGame&&t((function(){return void 0!==window.top.TGP.status})),e.isTgpMain=e.isWeGameMain,e.isWeGameMainTop=e.isWeGameMain&&t((function(){return window.top===window.parent&&window.top!==window})),e.isTgpMainTop=e.isWeGameMainTop,e.isWeGameFrame=e.isWeGameMain&&t((function(){return window.top===window})),e.isTgpFrame=e.isWeGameFrame,e.isWeGameCross=e.isWeGame&&t((function(){return/clienttype=cross/.test(window.location.href)})),e.isTgpCross=e.isWeGameCross,e.isWeGameIndependent=e.isWeGame&&!e.isWeGameMain&&!e.isWeGameCross,e.isTgpIndependent=e.isWeGameIndependent;var n=function(){try{return"production"}catch(e){return"production"}}();function o(t){if(!e.isBrowser&&!t)return null;var n=(t||window.navigator.userAgent).match(/(^| )WeGame\/([^/\s]*)( |$)/);return n&&n[2]?{version:n[2],versionAsNumber:n[2].split(".").reduce((function(e,t,n){return e|Number(t)<<24-8*n}),0)}:null}e.isDevelopment="development"===n,e.isTest="test"===n,e.isPreRelease="pre-release"===n||"prerelease"===n,e.isProduction=!e.isDevelopment&&!e.isTest&&!e.isPreRelease,e.isOversea=!1,e.isMainland=!e.isOversea,e.isWeGameX=e.isOversea,e.pageHost=e.isBrowser?window.location.host:"www.wegame.com.cn",e.getClientVersion=o,e.clientVersion=(o()||{}).versionAsNumber||0}(j);var D,k=!!j.isBrowser&&"https:"===location.protocol,q=k?"https://web1.ied-tqos-s.qq.com:8001":"http://ied-tqosweb.qq.com:8001",F=k?"https://tgp.ied-tqos-s.qq.com:8001":"http://ied-tqos-tgp.qq.com:8001";if(j.isBrowser)try{D=parent.TGP.status}catch(e){}function B(){var e=-1,t=0,n="0";D&&D.isNetbar>-1&&(e=D.isNetbar,D.uin&&(t=D.uin,n=D.ver.toString())),t=t||_()||0,0===Number(t)&&(t=P.get("tgp_id")?1e11+Number(P.get("tgp_id")):0);var r="0",o="0";return n&&(o=n.substr(0,4),r=n.substr(4,4)),void 0===e&&(window.tqosNetbarFlag=-1),{tqosNetbarFlag:e,uid:t,ver_high:o,ver_low:r}}function M(){var e=Date.now().toString();return{timestamp_high:e.substr(0,8),timestemp_low:e.substr(8)}}function U(e,t,n,r,o){var i=B(),s=i.tqosNetbarFlag,a=i.ver_high,c=i.ver_low,u=i.uid,l=M(),p=[a,c,l.timestamp_high,l.timestemp_low,e,s,t],f=["","",u,n,r];G(o,f,5);var d='{"Head":{"Cmd":5},"Body":{"QOSRep":{"BusinessID":1,"QosNum":1,"QosList":[{"QosID":'+e+',"QosVal":0,"AppendDescFlag":2,"AppendDesc":{"Comm":{"IntNum":'+p.length+',"IntList":['+p.join(",")+'],"StrNum":'+f.length+',"StrList":["'+f.join('","')+'"]}}}]}}}',m=F+"/?tqos="+encodeURIComponent(d);(new Image).src=m}function H(e){return e.replace(/[^\x00-\xff]/g,"***").length}function Q(e,t,n,r){if(!(n>r))if(H(String(e))<128)t.push(e);else{var o=function(e,t){var n="",r=e.length;if(H(e)<=t)return e;for(var o=0,i=0;o<r;o++){var s=e.charAt(o);if(/[\x00-\xff]/.test(s)?i+=1:i+=3,!(i<=t))return n;n+=s}return n}(e=String(e).replace(/\{/g,"｛").replace(/\}/g,"｝"),126);t.push(o),Q(e=e.slice(o.length,e.length),t,n+=1,r)}}function G(e,t,n){e&&("object"==typeof e&&(e="{"+Object.keys(e).map((function(t){return"'"+t+"':'"+e[t]+"'"})).join(";")+"}"),Q(e,t,0,n))}function W(e,t,n,r,o,i){var s=-1,a=0;D&&D.isNetbar>-1&&(s=D.isNetbar,D.uin&&(a=D.uin)),void 0!==a&&0!==Number(a)||(a=_()||0),void 0===s&&(window.tqosNetbarFlag=-1);for(var c=Date.now().toString(),u=[0,0,c.substr(0,4),c.substr(4,4),e,s,t],l=["","",a,n,r],p=o.replace(/"/g,"'").replace(/,/g,";"),f=0,d=p.length;f<d/127;f++){var m=p.slice(127*f,127*(f+1));l.push(m)}var g='{"Head":{"Cmd":5},"Body":{"QOSRep":{"BusinessID":1,"QosNum":1,"QosList":[{"QosID":'+e+',"QosVal":0,"AppendDescFlag":2,"AppendDesc":{"Comm":{"IntNum":'+u.length+',"IntList":['+u.join(",")+'],"StrNum":'+l.length+',"StrList":["'+l.join('","')+'"]}}}]}}}',h=(1===Number(i)?q:F)+"/?tqos="+encodeURIComponent(g);(new Image).src=h}var V=Object.freeze({__proto__:null,PV_REPORT_QOISID:8866,getClientInfo:B,getTimestamp:M,qosReport:U,qosPerformanceReport:function(e,t){var n=B(),r=n.uid,o=n.tqosNetbarFlag,i=n.ver_high,s=n.ver_low,a=M(),c=[i,s,a.timestamp_high,a.timestemp_low,7703,o],u=["","",r,e,"",window.__INITIAL_STATE__?"1":"0"];Object.keys(t).forEach((function(e){Number(e)<25&&(c[Number(e)+5]=t[e],delete t[e])})),G(t,u,4);var l='{"Head":{"Cmd":5},"Body":{"QOSRep":{"BusinessID":1,"QosNum":1,"Flag":1,"QosList":[{"QosID":7703,"QosVal":0,"AppendDescFlag":2,"AppendDesc":{"Comm":{"IntNum":'+c.length+',"IntList":['+c.join(",")+'],"StrNum":'+u.length+',"StrList":["'+u.join('","')+'"]}}}]}}}',p=F+"/?tqos="+encodeURIComponent(l);(new Image).src=p},qosCgiReport:function(e){var t=B(),n=t.uid,r=t.tqosNetbarFlag,o=t.ver_high,i=t.ver_low,s=M(),a=s.timestamp_high,c=s.timestemp_low,u=String(e.request_start),l=[o,i,a,c,5099,r,e.http_code,e.error_code,u.substr(0,8),u.substr(8),e.request_time],p=["","",n,e.api_url,e.refer_url,e.error_message],f='{"Head":{"Cmd":5},"Body":{"QOSRep":{"BusinessID":1,"QosNum":1,"Flag":1,"QosList":[{"QosID":5099,"QosVal":0,"AppendDescFlag":2,"AppendDesc":{"Comm":{"IntNum":'+l.length+',"IntList":['+l.join(",")+'],"StrNum":'+p.length+',"StrList":["'+p.join('","')+'"]}}}]}}}',d=F+"/?tqos="+encodeURIComponent(f);(new Image).src=d},$qosReportComm:function(e,t){var n=-1,r=0;D&&D.isNetbar>-1&&(n=D.isNetbar,D.uin&&(r=D.uin)),void 0===n&&(window.tqosNetbarFlag=-1);var o=Date.now().toString(),i=[0,0,0,o.substr(0,4),o.substr(4,4),e,n];i.push(t);for(var s=2;s<arguments.length&&"string"!=typeof arguments[s];++s)i.push(arguments[s]);for(var a=["","",r];s<arguments.length;++s)a.push(arguments[s]);var c='{"Head":{"Cmd":5},"Body":{"QOSRep":{"BusinessID":1,"QosNum":1,"QosList":[{"QosID":'+e+',"QosVal":0,"AppendDescFlag":2,"AppendDesc":{"Comm":{"IntNum":'+i.length+',"IntList":['+i.join(",")+'],"StrNum":'+a.length+',"StrList":["'+a.join('","')+'"]}}}]}}}',u=q+"/?tqos="+encodeURIComponent(c),l=new Image;l.src=u},$qosReportCommNew:function(e,t){var n=-1,r=0;D&&D.isNetbar>-1&&(n=D.isNetbar,D.uin&&(r=D.uin)),void 0!==r&&0!==Number(r)||(r=_()||0),void 0===n&&(window.tqosNetbarFlag=-1);var o=Date.now().toString(),i=[0,0,0,o.substr(0,4),o.substr(4,4),e,n];i.push(t);for(var s=2;s<arguments.length&&"string"!=typeof arguments[s];++s)i.push(arguments[s]);for(var a=["","",r];s<arguments.length;++s)a.push(arguments[s]);var c='{"Head":{"Cmd":5},"Body":{"QOSRep":{"BusinessID":1,"QosNum":1,"QosList":[{"QosID":'+e+',"QosVal":0,"AppendDescFlag":2,"AppendDesc":{"Comm":{"IntNum":'+i.length+',"IntList":['+i.join(",")+'],"StrNum":'+a.length+',"StrList":["'+a.join('","')+'"]}}}]}}}',u=F+"/?tqos="+encodeURIComponent(c),l=new Image;l.src=u},$qosReportCommOldEx:function(e,t,n,r,o){W(e,t,n,r,o,1)},$qosReportCommNewEx:function(e,t,n,r,o){W(e,t,n,r,o,2)}}),X={exports:{}};!function(e,t){e.exports=function(){var e=function(){},t={},n={},r={};function o(e,t){e=e.push?e:[e];var o,i,s,a=[],c=e.length,u=c;for(o=function(e,n){n.length&&a.push(e),--u||t(a)};c--;)i=e[c],(s=n[i])?o(i,s):(r[i]=r[i]||[]).push(o)}function i(e,t){if(e){var o=r[e];if(n[e]=t,o)for(;o.length;)o[0](e,t),o.splice(0,1)}}function s(t,n){t.call&&(t={success:t}),n.length?(t.error||e)(n):(t.success||e)(t)}function a(t,n,r,o){var i,s,c=document,u=r.async,l=(r.numRetries||0)+1,p=r.before||e,f=t.replace(/[\?|#].*$/,""),d=t.replace(/^(css|img)!/,"");o=o||0,/(^css!|\.css$)/.test(f)?((s=c.createElement("link")).rel="stylesheet",s.href=d,(i="hideFocus"in s)&&s.relList&&(i=0,s.rel="preload",s.as="style")):/(^img!|\.(png|gif|jpg|svg|webp)$)/.test(f)?(s=c.createElement("img")).src=d:((s=c.createElement("script")).src=t,s.async=void 0===u||u),s.onload=s.onerror=s.onbeforeload=function(e){var c=e.type[0];if(i)try{s.sheet.cssText.length||(c="e")}catch(e){18!=e.code&&(c="e")}if("e"==c){if((o+=1)<l)return a(t,n,r,o)}else if("preload"==s.rel&&"style"==s.as)return s.rel="stylesheet";n(t,c,e.defaultPrevented)},!1!==p(t,s)&&c.head.appendChild(s)}function c(e,t,n){var r,o,i=(e=e.push?e:[e]).length,s=i,c=[];for(r=function(e,n,r){if("e"==n&&c.push(e),"b"==n){if(!r)return;c.push(e)}--i||t(c)},o=0;o<s;o++)a(e[o],r,n)}function u(e,n,r){var o,a;if(n&&n.trim&&(o=n),a=(o?r:n)||{},o){if(o in t)throw"LoadJS";t[o]=!0}function u(t,n){c(e,(function(e){s(a,e),t&&s({success:t,error:n},e),i(o,e)}),a)}if(a.returnPromise)return new Promise(u);u()}return u.ready=function(e,t){return o(e,(function(e){s(t,e)})),u},u.done=function(e){i(e,[])},u.reset=function(){t={},n={},r={}},u.isDefined=function(e){return e in t},u}()}(X);var $=X.exports,J=!!j.isBrowser&&"https:"===location.protocol,z=!1;function Y(e){if(z)return e();$(J?"//pingjs.qq.com/tcss.ping.https.js":"//pingjs.qq.com/tcss.ping.js",(function(){z=!0,e()}))}var K,Z=j.isBrowser?location.pathname.replace(/\/store\/\d{1,}/,"/store/detail"):"";function ee(){return P.get("tgp_id")||""}function te(){var e,t;try{return(null===(t=null===(e=top.TGP)||void 0===e?void 0:e.status)||void 0===t?void 0:t.ver)?function(e){var t=Number(e);if(!e||!t)return"0";var n=[(4278190080&t)>>24];return n.push((16711680&t)>>16),n.push(65535&t),n.join(".")}(top.TGP.status.ver):"0"}catch(e){return"0"}}function ne(e){if(null==e?void 0:e.from)return e.from;var t=N.parse(window.location.search,{ignoreQueryPrefix:!0}).from||function(e){if(!e||j.isWeGame||!sessionStorage)return"";var t=document.referrer,n=sessionStorage.getItem("last_referrer"),r=sessionStorage.getItem("custom_json"),o={};if(r)try{var i=JSON.parse(r);i.path&&(i.path===t||i.path===location.href&&!t||t===location.href&&i.path===n)&&(o=i)}catch(e){}return o[e]||""}("from");return t.match(/[^\dA-Za-z.\-_]/)&&(t="unsafe"),j.isWeGame&&!t&&(t="client.wegame"),t}function re(e,t){return t&&e&&void 0!==e[t]?t+"="+e[t]:""}function oe(e){void 0===e&&(e={});var t=e.tgameid,r=n(e,["tgameid"]);void 0!==t&&void 0===r.game_id&&(r.game_id=t);var o={};return Object.keys(r).forEach((function(e){return o["s_"+e]=r[e]})),o}function ie(e,t){void 0===t&&(t=!1),(K=K||document.createElement("a")).href=e;var n="";if(t){var r=decodeURIComponent(K.search).match(/ADTAG=([^&]+)/i);(null==r?void 0:r[1])&&(n="ADTAG="+r[1])}return K.search=n,K.hash="",K.href}var se={appkey:"0WEB0A20294YU9L9",strictMode:!1,onReportBeforeSend:function(e){var n,r;void 0===e&&(e={});var o=t({},e),i=null===(r=null===(n=e.data)||void 0===n?void 0:n.common)||void 0===r?void 0:r.A102;return i&&(o.data.common.A102=ie(i,!0)),o}},ae={id:"jyMsoCbcSuYHtDaOKe",reportApiSpeed:!0,reportAssetSpeed:!0,offlineLog:!0,onBeforeRequest:function(e){void 0===e&&(e={});var n=e.url,r=function(e){if(!e)return e;var t=e.match(/from=([^&]*)/),n=(null==t?void 0:t[1])||"";return n?(n=ie(n=decodeURIComponent(n)),n=encodeURIComponent(n),e.replace(/(from=)([^&]*)/gi,"from="+n)):e}(e.url);return t(t({},e),{url:r,ourl:n})}},ce={env:"cn",appId:837297941,srcId:15033,eventName:"web_report"},ue={name:"BeaconAction",url:"https://beaconcdn.qq.com/sdk/4.3.4/beacon_web.min.js"},le={name:"TDM",url:"https://game.gtimg.cn/images/js/tdm/tdm.js"};function pe(e,r,o){var i,s,a=e,c=o,u=a[c],l=n(a,["symbol"==typeof c?c:c+""]),p=r,f=o,d=p[f],m=n(p,["symbol"==typeof f?f:f+""]),g=((i={})[o]=function(e){try{return[u,d].reduce((function(e,t){return"function"==typeof t?t(e):e}),e)}catch(t){return e}},i);return t(t(t({},l),m),((s={})[o]=g[o],s))}function fe(e,t){return"undefined"==typeof window?t:e in window?window[e].bind(window):t}var de,me=fe("requestIdleCallback",(function(e,t){return setTimeout((function(){var t=Date.now();e({didTimeout:!1,timeRemaining:function(){return Math.max(0,50-(Date.now()-t))}})}),1)}));fe("cancelIdleCallback",(function(e){clearTimeout(e)}));var ge,he=function(){function e(e){var t=this;void 0===e&&(e={});var n=e.beaconOptions,r=void 0===n?{}:n,o=e.TDMOptions,i=void 0===o?{}:o;this.clientVersion=te(),this.userid=ee(),this.userQQ=(P.get("puin")||P.get("p_uin")||"").replace(/^o0*/g,""),this.userType=P.get("tgp_user_type")||"",this.beaconOptions=r,this.TDMOptions=i,me((function(){t.lazyBeacon()}),{timeout:1e3})}return e.prototype.lazyBeacon=function(){var e=this;return this.beacon||(this.beacon=(de||(de=$(ue.url,{returnPromise:!0}).then((function(){return window[ue.name]}))),de).then((function(t){var n=pe(se,e.beaconOptions,"onReportBeforeSend");return n.openid||(n.openid=e.userid),new t(n)}))),this.beacon},e.prototype.lazyTDM=function(){var e=this;return this.tdm||(this.tdm=(ge||(ge=$(le.url,{returnPromise:!0}).then((function(){return window[le.name]}))),ge).then((function(r){var o=t(t({userId:e.userid},ce),e.TDMOptions),i=o.srcId,s=void 0===i?0:i,a=o.eventName,c=void 0===a?"":a,u=n(o,["srcId","eventName"]);return r.init(u).catch((function(e){return console.error("TDM init error",e)})),{TDM:r,srcId:s,eventName:c}}))),this.tdm},e.prototype.setOpenId=function(e){this.userid=e,this.lazyBeacon().then((function(t){return t.setOpenId(e)}))},e.prototype.reportEvent=function(e,r,o){void 0===r&&(r={}),void 0===o&&(o={});var i=o.immediate,s=void 0!==i&&i,a=o.sendBeacon,c=void 0!==a&&a,u=o.realTimeAnalysis,l=void 0!==u&&u,p=ne(r),f=function(){var e="";try{var t=sessionStorage.getItem("user_path_track");if(t){var n=JSON.parse(t);Array.isArray(n)&&n.length&&(e=t)}}catch(e){}return e}(),d=r.page,m=n(r,["page"]),g=t(t({clientver:this.clientVersion,uid:this.userid,utype:this.userType,qq:this.userQQ},m),{efrom:p,track:f}),h=e.replace(/\./g,"_"),v=s?"onDirectUserAction":"onUserAction";v=c?"onSendBeacon":v,this.lazyBeacon().then((function(e){e[v](h,g)})),l&&this.lazyTDM().then((function(e){var n=e.TDM,r=e.srcId,o=e.eventName;n.reportEvents({events:[{srcId:r,eventName:o,eventInfo:oe(t({page:d},g))}]})}))},e}(),ve={exports:{}};!function(e,t){e.exports=function(){function e(e){return(e=Array.isArray(e)?e:[e]).map((function(e,t){return Object.getOwnPropertyNames(e).map((function(n){return r(n)+"["+t+"]="+(void 0===e[n]?"":r(e[n]))})).join("&")})).join("&")+(e.length?"&count="+e.length:"")}var t,n=(o.prototype.indexOf=function(e,t){for(var n=0;n<e.length;n++)if(e[n].callback===t)return n;return-1},o.prototype.on=function(e,t,n){if(void 0===n&&(n=0),this){var r=this.EventsList[e];return r||(this.EventsList[e]=[],r=this.EventsList[e]),-1!==this.indexOf(r,t)||r.push({name:e,type:n||0,callback:t}),this}},o.prototype.one=function(e,t){this.on(e,t,1)},o.prototype.remove=function(e,t){if(this){var n=this.EventsList[e];if(!n)return null;if(t)return n.length&&(t=this.indexOf(n,t),n.splice(t,1)),this;try{delete this.EventsList[e]}catch(e){}return null}},o),r=function(e){try{return encodeURIComponent(decodeURIComponent(e))}catch(t){return e}};function o(){var e=this;this.emit=function(t,n){if(e){var r;if(null!=(o=e.EventsList[t])&&o.length)for(var o=o.slice(),i=0;i<o.length;i++){r=o[i];try{var s=r.callback.apply(e,[n]);if(1===r.type&&e.remove(t,r.callback),!1===s)break}catch(t){throw t}}return e}},this.EventsList={}}function i(e,n){return"number"==typeof e||"string"==typeof e?e:n?t.string:t.number}function s(e,t){return"string"==typeof e?e.split("?")[t?1:0]||"":e}function a(e){return/^https/.test(e)}function c(){return void 0!==window.performance&&"function"==typeof performance.clearResourceTimings&&"function"==typeof performance.getEntriesByType&&"function"==typeof performance.now}function u(e){return d.some((function(t){return-1!==e.indexOf(t)}))}function l(e){if("string"==typeof e)return e;try{return(JSON.stringify(e,(t=[],n=[],function(e,r){if(r instanceof Error)return"Error.message: "+r.message+" \n  Error.stack: "+r.stack;if("object"==typeof r&&null!==r){var o=t.indexOf(r);if(-1!==o)return"[Circular "+n[o]+"]";t.push(r),n.push(e||"root")}return r}),4)||"undefined").replace(/"/gim,"")}catch(e){return"error happen when aegis stringify: \n "+e.message+" \n "+e.stack}var t,n}(ee=t=t||{})[ee.number=-1]="number",ee.string="";var p,f,d=["application/octet-stream","application/xhtml+xml","application/xml","application/pdf","application/pkcs12","application/javascript","application/ecmascript","application/vnd.mspowerpoint","application/ogg","text/html","text/css","text/javascript","image","audio","video"],m=["ret","retcode","code"],g=function(e,t){var n,r;try{"string"==typeof e&&(e=JSON.parse(e)),"function"==typeof(null===(n=null==t?void 0:t.ret)||void 0===n?void 0:n.join)&&(m=[].concat(null===(r=null==t?void 0:t.ret)||void 0===r?void 0:r.map((function(e){return e.toLowerCase()}))));var o=Object.getOwnPropertyNames(e).filter((function(e){return-1!==m.indexOf(e.toLowerCase())}));return o.length?""+e[o[0]]:"unknown"}catch(e){return"unknown"}},h=(w.prototype.sourceURL=function(){return this.data.responseURL},w.prototype.status=function(){return Number(this.data.status)},w.prototype.headers=function(){var e=this.data.getAllResponseHeaders().split("\n"),t={};return e.forEach((function(e){var n;e&&(e=(n=e.split(": "))[0],n=n[1].trim(),t[e]=n)})),t},w),v=(y.prototype.sourceURL=function(){return this.data.url},y.prototype.status=function(){return Number(this.data.status)},y.prototype.headers=function(){var e={};return this.data.headers.forEach((function(t,n){e[n]=t})),e},y);function y(e,t){this.type="fetch",this.data=e||{},this.data.response=t}function w(e){this.type="xhr",this.data=e}function b(e,t){return Array.isArray(e)?t(e.map((function(e){return{msg:"string"==typeof e.msg?e.msg:[].concat(e.msg).map(l).join(" "),level:e.level,trace:e.trace}}))):t({msg:"string"==typeof e.msg?e.msg:l(e.msg),level:e.level,trace:e.trace})}function O(){}(ne=p=p||{}).INFO_ALL="-1",ne.API_RESPONSE="1",ne.INFO="2",ne.ERROR="4",ne.PROMISE_ERROR="8",ne.AJAX_ERROR="16",ne.SCRIPT_ERROR="32",ne.IMAGE_ERROR="64",ne.CSS_ERROR="128",ne.CONSOLE_ERROR="256",ne.MEDIA_ERROR="512",ne.RET_ERROR="1024",ne.REPORT="2048",(re=f=f||{}).LOG="log",re.SPEED="speed",re.PERFORMANCE="performance",re.OFFLINE="offline",re.WHITE_LIST="whiteList",re.VITALS="vitals",re.PV="pv",re.CUSTOME_PV="customPV",re.EVENT="event",re.CUSTOM="custom",re.SDK_ERROR="sdkError";var E=function(e,t){var n,r=[];return function(o,i){if(r.push(o),t&&r.length>=t)return i(r.splice(0,r.length)),void(n&&clearTimeout(n));n&&clearTimeout(n),n=setTimeout((function(){n=null,i(r.splice(0,r.length))}),e.delay)}},S=!0,R=function(e){var t={};return function(n,r){var o;e.speedSample?Array.isArray(n)?(o=n.filter((function(e){var n=!t[e.url];return t[e.url]=!0,n}))).length&&r(o):(t[n.url]||r(n),t[n.url]=!0):r(n)}},C=function(e){if(!e||!e.reduce||!e.length)throw new TypeError("createPipeline need at least one function param");return 1===e.length?function(t,n){e[0](t,n||O)}:e.reduce((function(e,t){return function(n,r){return void 0===r&&(r=O),e(n,(function(e){return null==t?void 0:t(e,r)}))}}))},x=(P.prototype.init=function(e){this.setConfig(e);for(var t=0;t<P.installedPlugins.length;t++)try{P.installedPlugins[t].patch(this)}catch(e){this.sendSDKError(e)}this.lifeCycle.emit("onInited")},P.prototype.setConfig=function(e){Object.assign(this.config,e);var t=(a=this.config).id,n=a.uin,r=a.version,o=a.ext1,i=a.ext2,s=a.ext3,a=(e=a.aid,this.bean.id!==t||this.bean.uin!==n||this.bean.aid!==e);return this.bean.id=t||"",this.bean.uin=n||"",this.bean.version=r||"1.33.9",this.bean.aid=e||"",o&&(this.bean.ext1=o),i&&(this.bean.ext2=i),s&&(this.bean.ext3=s),a&&this.lifeCycle.emit("onConfigChange",this.config),this.config},P.use=function(e){-1===P.installedPlugins.indexOf(e)&&e.aegisPlugin&&P.installedPlugins.push(e)},P.prototype.info=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.normalLogPipeline({msg:e,level:p.INFO})},P.prototype.infoAll=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.normalLogPipeline({msg:e,level:p.INFO_ALL})},P.prototype.report=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.normalLogPipeline({msg:e,level:p.REPORT})},P.prototype.error=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.normalLogPipeline({msg:e,level:p.ERROR})},P.prototype.speedLogPipeline=function(e){throw new Error('You need to override "speedLogPipeline" method')},P.prototype.reportPv=function(e){var t,n=this;e&&(t=""+Object.getOwnPropertyNames(this.bean).filter((function(e){return"id"!==e})).map((function(e){return e+"="+n.bean[e]})).join("&"),this.send({url:this.config.url+"/"+e+"?"+t,addBean:!1,type:f.CUSTOME_PV}))},P.prototype.reportEvent=function(e){e&&this.eventPipeline(e)},P.prototype.reportTime=function(e,t){if("object"==typeof e)return this.reportT(e);"string"==typeof e?"number"==typeof t?t<0||6e4<t?console.warn("reportTime: duration must between 0 and 60000"):this.submitCustomTime(e,t):console.warn("reportTime: second param must be number"):console.warn("reportTime: first param must be a string")},P.prototype.reportT=function(e){var t=e.name,n=e.duration,r=void 0===(o=e.ext1)?"":o,o=void 0===(i=e.ext2)?"":i,i=void 0===(i=e.ext3)?"":i;if(e=e.from,"string"==typeof t&&"number"==typeof n&&"string"==typeof r&&"string"==typeof o&&"string"==typeof i){if(!(n<0||6e4<n))return this.submitCustomTime(t,n,r,o,i,void 0===e?"":e);console.warn("reportTime: duration must between 0 and 60000")}else console.warn("reportTime: params error")},P.prototype.time=function(e){"string"==typeof e?this.timeMap[e]?console.warn("Timer "+e+" already exists"):this.timeMap[e]=Date.now():console.warn("time: first param must be a string")},P.prototype.timeEnd=function(e){"string"==typeof e?this.timeMap[e]?(this.submitCustomTime(e,Date.now()-this.timeMap[e]),delete this.timeMap[e]):console.warn("Timer "+e+" does not exist"):console.warn("timeEnd: first param must be a string")},P.prototype.submitCustomTime=function(e,t,n,r,o,i){this.customTimePipeline({name:e,duration:t,ext1:n||this.config.ext1,ext2:r||this.config.ext2,ext3:o||this.config.ext3,from:i||void 0})},P.prototype.extendBean=function(e,t){this.bean[e]=t},P.prototype.send=function(e,t,n){throw new Error('You need to override "send" method')},P.prototype.sendSDKError=function(e){this.send({url:"https://aegis.qq.com/collect?id=1085&msg[0]="+encodeURIComponent(l(e))+"&level[0]=2&from="+this.config.id+"&count=1&version="+this.config.id+"(1.33.9)",addBean:!1,method:"get",type:f.SDK_ERROR})},P.LOG_TYPE=p,P.installedPlugins=[],P),I=(A.prototype.patch=function(e){this.canUse(e)&&this.exist(e)&&(this.instances.push(e),this.triggerInit(e),this.triggerOnNewAegis(e))},A.prototype.walk=function(e){var t=this;this.instances.forEach((function(n){var r=t.canUse(n);r&&e(n,r)}))},A.prototype.canUse=function(e){return!(!(e=this.getConfig(e))||"object"!=typeof e)||!!e},A.prototype.getConfig=function(e){return e.config[this.name]},A.prototype.exist=function(e){return-1===this.instances.indexOf(e)},A.prototype.triggerInit=function(e){var t;this.inited||(this.inited=!0,null===(t=null===(t=this.option)||void 0===t?void 0:t.init)||void 0===t||t.call(this.option,this.getConfig(e)))},A.prototype.triggerOnNewAegis=function(e){var t;null===(t=null===(t=this.option)||void 0===t?void 0:t.onNewAegis)||void 0===t||t.call(this.option,e,this.getConfig(e))},A),T=new I({name:"aid",aid:"",init:function(e){try{var t=!0!==e&&e||window.localStorage.getItem("AEGIS_ID");t||(t="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){var t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)})),window.localStorage.setItem("AEGIS_ID",t)),this.aid=t}catch(e){}},onNewAegis:function(e){e.bean.aid=this.aid,e.config.aid=this.aid}}),L=(new I({name:"reportAssetSpeed"}),new I({name:"reportAssetSpeed",collectCur:0,ASSETS_INITIATOR_TYPE:["img","css","script","link","audio","video"],onNewAegis:function(e){var t=this;c()&&(this.collectSuccLog(e.config),this.collectFailLog(e.config),performance.onresourcetimingbufferfull=function(){t.collectCur=0,performance.clearResourceTimings()})},publish:function(e){this.$walk((function(t){t.speedLogPipeline(e)}))},collectSuccLog:function(e){function t(t){for(var r=0,o=t.length;r<o;r++){var i=t[r];-1!==n.ASSETS_INITIATOR_TYPE.indexOf(i.initiatorType)&&-1===i.name.indexOf("cdn-go.cn/aegis/aegis-sdk")&&n.publish(n.generateLog(i,e))}}var n=this;"function"==typeof window.PerformanceObserver?(t(performance.getEntriesByType("resource")),new window.PerformanceObserver((function(e){t(e.getEntries())})).observe({entryTypes:["resource"]})):setInterval((function(){var e=performance.getEntriesByType("resource"),r=e.slice(n.collectCur);n.collectCur=e.length,t(r)}),3e3)},collectFailLog:function(e){var n=this;window.document.addEventListener("error",(function(r){var o,i;r&&(r=(null==(o=r.target||r.srcElement)?void 0:o.src)||(null==o?void 0:o.href),i="function"==typeof(null===(o=null==e?void 0:e.api)||void 0===o?void 0:o.resourceTypeHandler)?null===(i=null==e?void 0:e.api)||void 0===i?void 0:i.resourceTypeHandler(r):"",r&&(r={url:s(r),status:400,method:"get",type:i||"static",isHttps:a(r),urlQuery:s(r,!0),x5ContentType:t.string,x5HttpStatusCode:t.number,x5ImgDecodeStatus:t.number,x5ErrorCode:t.number,x5LoadFromLocalCache:t.number,x5ContentLength:t.number,domainLookup:t.number,connectTime:t.number},n.publish(r)))}),!0)},generateLog:function(e,n){var r,o="function"==typeof(null===(r=null==n?void 0:n.api)||void 0===r?void 0:r.resourceTypeHandler)?null===(o=null==n?void 0:n.api)||void 0===o?void 0:o.resourceTypeHandler(e.name):"";return{url:s(e.name),method:"get",duration:Number(e.duration.toFixed(2)),status:200,type:o||"static",isHttps:a(e.name),urlQuery:s(e.name,!0),x5ContentType:i(e.x5ContentType,!0),x5HttpStatusCode:i(e.x5HttpStatusCode),x5ImgDecodeStatus:i(e.x5ImgDecodeStatus),x5ErrorCode:i(e.x5ErrorCode),x5LoadFromLocalCache:void 0===e.x5LoadFromLocalCache?t.number:0|e.x5LoadFromLocalCache,x5ContentLength:e.encodedBodySize||i(e.x5ContentLength),domainLookup:i(e.domainLookupEnd-e.domainLookupStart),connectTime:i(e.connectEnd-e.connectStart)}}})),N=function(e,t){return(N=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)};function A(e){this.aegisPlugin=!0,this.name="",this.instances=[],this.inited=!1,e.$walk=this.walk.bind(this),e.$getConfig=this.getConfig.bind(this),this.option=e,this.name=e.name}function P(t){var r,o,i,s,a=this;this.config={version:0,delay:1500,onError:!0,repeat:5,random:1,aid:!0,device:!0,pagePerformance:!0,webVitals:!0,speedSample:!0,url:"https://aegis.qq.com/collect",speedUrl:"https://aegis.qq.com/speed",customTimeUrl:"https://aegis.qq.com/speed/custom",whiteListUrl:"https://aegis.qq.com/collect/whitelist",pvUrl:"https://aegis.qq.com/aegis/whitelist",performanceUrl:"https://aegis.qq.com/speed/performance",webVitalsUrl:"https://aegis.qq.com/speed/webvitals",eventUrl:"https://aegis.qq.com/collect/events"},this.isWhiteList=!1,this.lifeCycle=new n,this.bean={},this.normalLogPipeline=C([E(this.config,5),b,(i=this.config,s={},function(e,t){var n="number"==typeof i.repeat?i.repeat:5;if(0===n)return t(e);t(e.filter((function(e){return e.level!==p.ERROR&&e.level!==p.PROMISE_ERROR&&e.level!==p.AJAX_ERROR&&e.level!==p.SCRIPT_ERROR&&e.level!==p.IMAGE_ERROR&&e.level!==p.CSS_ERROR&&e.level!==p.MEDIA_ERROR||(s[e.msg]=s[e.msg]||0,s[e.msg]+=1,!(s[e.msg]>n))})))}),(r=this.lifeCycle.emit,o=this.config,function(e,t){var n=o.logCreated;return"function"!=typeof n?(r("beforeWrite",e),t(e)):(e=e.filter((function(e){return!1!==n(e)})),r("beforeWrite",e),t(e))}),function(e){var t,n=!1,r=!1,o=!1;e.lifeCycle.on("onConfigChange",(function(){t&&clearTimeout(t),t=setTimeout((function(){var t,i;o||(o=!0,t=(i=e.config).pvUrl,i=i.whiteListUrl,e.send({url:S?void 0===t?"":t:void 0===i?"":i,type:S?f.PV:f.WHITE_LIST},(function(t){r=!0;try{0===(t=JSON.parse(t)||{}).retcode&&(n=t.result.is_in_white_list,e.isWhiteList=n);var o=e.config.onWhitelist;"function"==typeof o&&o(n)}catch(t){}}),(function(){r=!0})),o=S=!1)}),e.config.uin?50:500)}));var i=[],s=!1;return function(e,t){!s&&e.some((function(e){return e.level===p.ERROR}))&&(s=!0),n||s?t(e.concat(i.splice(0)).map((function(e){return e.level===p.INFO_ALL&&(e.level=p.INFO),e}))):(e=e.filter((function(e){return e.level!==p.INFO&&e.level!==p.API_RESPONSE?(e.level===p.INFO_ALL&&(e.level=p.INFO),!0):(r||(i.push(e),200<=i.length&&(i.length=200)),!1)}))).length&&t(e)}}(this),function(e,t){var n=JSON.parse(JSON.stringify(e));a.lifeCycle.emit("beforeReport",n);var r=a.config.beforeReport;if((e="function"==typeof r?e.filter((function(e){return!1!==r(e)})):e).length)return t(e)},function(t){a.send({url:a.config.url||"",data:e(t),method:"post",contentType:"application/x-www-form-urlencoded",type:f.LOG},(function(){var e=a.config.onReport;"function"==typeof e&&t.forEach((function(t){e(t)}))}))}]),this.eventPipeline=C([E(this.config,5),function(e){a.send({url:a.config.eventUrl+"?"+e.map((function(e,t){if("string"==typeof e)return"event["+t+"]="+encodeURIComponent(e);var n=encodeURIComponent(e.ext1||a.config.ext1||""),r=encodeURIComponent(e.ext2||a.config.ext2||""),o=encodeURIComponent(e.ext3||a.config.ext3||"");return"event["+t+"]="+encodeURIComponent(e.name)+"&ext1["+t+"]="+n+"&ext2["+t+"]="+r+"&ext3["+t+"]="+o})).join("&"),type:f.EVENT})}]),this.timeMap={},this.customTimePipeline=C([E(this.config,10),function(e){a.send({url:a.config.customTimeUrl+"?payload="+encodeURIComponent(JSON.stringify({custom:e})),type:f.CUSTOM})}])}var j=function(){return(j=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};function _(e){var t,n;M.push(e),!B&&window.XMLHttpRequest&&(B=!0,t=window.XMLHttpRequest.prototype.send,n=window.XMLHttpRequest.prototype.open,window.XMLHttpRequest.prototype.open=function(){if(this.aegisMethod=arguments[0],this.aegisUrl=arguments[1],!this.sendByAegis)for(var e=0;e<M.length;e++){var t=M[e];try{"function"==typeof t.open&&t.open(this)}catch(e){}}return n.apply(this,arguments)},window.XMLHttpRequest.prototype.send=function(){if(!this.sendByAegis)for(var e=0;e<M.length;e++){var n=M[e];try{"function"==typeof n.send&&n.send(this,arguments[0])}catch(e){}}return t.apply(this,arguments)})}function D(e){var t;H.push(e),!U&&window.fetch&&(U=!0,t=window.fetch,window.fetch=function(e,n){void 0===n&&(n={});for(var r="string"==typeof e?e:e.url,o=0;o<H.length;o++){var i=H[o];try{"function"==typeof i.beforeFetch&&i.beforeFetch(r,n)}catch(e){}}var s=Date.now();return t(e,n).then((function(e){for(var t=0;t<H.length;t++){var o=H[t];try{"function"==typeof o.then&&o.then(e,Date.now()-s,r,n)}catch(e){}}return e})).catch((function(e){for(var t=0;t<H.length;t++){var o=H[t];try{"function"==typeof o.catch&&o.catch(e,Date.now()-s,r,n)}catch(e){}}throw e}))})}var k,q,F,B=!1,M=[],U=!1,H=[],Q=(new I({name:"reportApiSpeed"}),new I({name:"reportApiSpeed",override:!1,onNewAegis:function(e,t){this.override||(this.override=!0,this.overrideFetch(e.config),this.overrideXhr(e.config))},overrideFetch:function(e){var n=this;D({then:function(r,o,i,c){var f,d,m,h={url:r.url,isHttps:a(r.url),method:(null==c?void 0:c.method)||"get",duration:o,type:"fetch",status:r.status};"fetch"!==(m="function"==typeof(null===(f=null==e?void 0:e.api)||void 0===f?void 0:f.resourceTypeHandler)?null===(d=null==e?void 0:e.api)||void 0===d?void 0:d.resourceTypeHandler(r.url):m)&&"static"!==m&&(d=r.headers?r.headers.get("content-type"):"",m=r.ok&&"string"==typeof d&&u(d)?"static":"fetch"),"fetch"===m?r.clone().text().then((function(t){var s,a,u,f,d="req url: "+i+" \n                                \nreq method: "+((null==c?void 0:c.method)||"get")+" \n                                \nreq param: "+l(null==c?void 0:c.body)+" \n                                \nres duration: "+o+" \n                                \nres status: "+r.status+" \n                                \nres data: "+t;n.publishNormalLog({msg:d,level:p.API_RESPONSE}),h.payload=new v(r,t),("function"==typeof(null===(s=null==e?void 0:e.api)||void 0===s?void 0:s.retCodeHandler)?(f=(u=e.api.retCodeHandler(t,r.url,r)).code,a=u.isErr,h.ret=f,a):(u=g(t,e.api),h.ret=u,t=(t=null===(a=e.api)||void 0===a?void 0:a.errCode)&&[].concat(t),f=(f=null===(a=e.api)||void 0===a?void 0:a.code)&&[].concat(f),t&&-1!==t.indexOf(u)||f&&-1===f.indexOf(u)||!t&&!f&&"0"!==u&&"unknown"!==u))&&n.publishNormalLog({msg:d,level:p.RET_ERROR})})):Object.assign(h,{type:"static",urlQuery:s(r.url,!0),x5ContentType:t.string,x5HttpStatusCode:t.number,x5ImgDecodeStatus:t.number,x5ErrorCode:t.number,x5LoadFromLocalCache:t.number,x5ContentLength:t.number,domainLookup:t.number,connectTime:t.number}),n.publishSpeed(h)},catch:function(e,t,r,o){t={url:r,isHttps:a(r),method:(null==o?void 0:o.method)||"get",duration:t,type:"fetch",status:600},n.publishSpeed(t)}})},getRequestType:function(e,t,n){var r,o="function"==typeof(null===(r=null==e?void 0:e.api)||void 0===r?void 0:r.resourceTypeHandler)?null===(o=null==e?void 0:e.api)||void 0===o?void 0:o.resourceTypeHandler(n):"";return"fetch"!==o&&"static"!==o&&(n=t.getResponseHeader("content-type"),o=400<=t.status||"string"!=typeof n||!u(n)?"fetch":"static"),o},overrideXhr:function(e){var n=this;_({send:function(r,o){var i=Date.now();r.addEventListener("loadend",(function(){var c,u,f,d=r.aegisUrl;if(d){var m=Date.now()-i,v={url:d,isHttps:a(d),status:r.status,method:r.aegisMethod||"get",type:"fetch",duration:m,payload:new h(r)};if("fetch"===n.getRequestType(e,r,d))try{var y,w,b,O,E,S="req url: "+d+" \n                                \nreq method: "+(r.aegisMethod||"get")+" \n                                \nreq param: "+l(o)+" \n                                \nres duration: "+m+" \n                                \nres status: "+r.status+" \n                                \nres data: "+l(r.response);n.publishNormalLog({msg:S,level:p.API_RESPONSE,trace:r.aegisTjgTrace}),("function"==typeof(null===(c=null==e?void 0:e.api)||void 0===c?void 0:c.retCodeHandler)?(E=(y=e.api.retCodeHandler(r.response,d,r)).code,w=y.isErr,v.ret=E,w):(b=g(r.response,e.api),v.ret=b,O=(O=null===(u=e.api)||void 0===u?void 0:u.errCode)&&[].concat(O),E=(E=null===(f=e.api)||void 0===f?void 0:f.code)&&[].concat(E),O&&-1!==O.indexOf(b)||E&&-1===E.indexOf(b)||!O&&!E&&"0"!==b&&"unknown"!==b))&&n.publishNormalLog({msg:S,level:p.RET_ERROR})}catch(c){v.ret="unknown"}else Object.assign(v,{type:"static",urlQuery:s(d,!0),x5ContentType:t.string,x5HttpStatusCode:t.number,x5ImgDecodeStatus:t.number,x5ErrorCode:t.number,x5LoadFromLocalCache:t.number,x5ContentLength:t.number,domainLookup:t.number,connectTime:t.number});n.publishSpeed(v)}}))}})},publishSpeed:function(e){var t=this;e.url=s(e.url),this.$walk((function(n){var r=t.$getConfig(n);"fetch"===e.type&&r&&"function"==typeof r.urlHandler?n.speedLogPipeline(j(j({},e),{url:encodeURIComponent(r.urlHandler(e.url,e.payload))})):n.speedLogPipeline(e)}))},publishNormalLog:function(e){this.$walk((function(t){t.normalLogPipeline(e)}))}}));function G(e){return{name:e,value:1<arguments.length&&void 0!==arguments[1]?arguments[1]:-1,delta:0,entries:[],id:"".concat(Date.now(),"-").concat(Math.floor(8999999999999*Math.random())+1e12),isFinal:!1}}function W(e,t){try{if(PerformanceObserver.supportedEntryTypes.includes(e)){var n=new PerformanceObserver((function(e){return e.getEntries().map(t)}));return n.observe({type:e,buffered:!0}),n}}catch(e){}}function V(e){oe=!e.persisted}function X(e){var t=1<arguments.length&&void 0!==arguments[1]&&arguments[1];ie||(addEventListener("pagehide",V),addEventListener("beforeunload",(function(){})),ie=!0),addEventListener("visibilitychange",(function(t){t=t.timeStamp,"hidden"===document.visibilityState&&e({timeStamp:t,isUnloading:oe})}),{capture:!0,once:t})}function $(e,t,n,r){var o;return function(){n&&t.isFinal&&n.disconnect(),0<=t.value&&(r||t.isFinal||"hidden"===document.visibilityState)&&(t.delta=t.value-(o||0),(t.delta||t.isFinal||void 0===o)&&(e(t),o=t.value))}}function J(){return void 0===K&&(K="hidden"===document.visibilityState?0:1/0,X((function(e){return e=e.timeStamp,K=e}),!0)),{get timeStamp(){return K}}}function z(e){if(e.payload){var t={};return Object.keys(e).forEach((function(n){"payload"!==n&&(t[n]=e[n])})),t}return e}(se=k=k||{})[se.unknown=100]="unknown",se[se.wifi=1]="wifi",se[se.net2g=2]="net2g",se[se.net3g=3]="net3g",se[se.net4g=4]="net4g",se[se.net5g=5]="net5g",se[se.net6g=6]="net6g",(ce=q=q||{})[ce.android=1]="android",ce[ce.ios=2]="ios",ce[ce.windows=3]="windows",ce[ce.macos=4]="macos",ce[ce.linux=5]="linux",ce[ce.other=100]="other",(me=F=F||{})[me.oldX5=1]="oldX5",me[me.newX5=2]="newX5",me[me.other=3]="other";var Y,K,Z,ee=new I({name:"device",onNewAegis:function(e){e.extendBean("platform",this.getPlatform()),e.extendBean("x5Type",this.getX5Type()),e.extendBean("netType",k.unknown),this.refreshNetworkTypeToBean(e)},getPlatform:function(){var e={android:/\bAndroid\s*([^;]+)/,ios:/\b(iPad|iPhone|iPod)\b.*? OS ([\d_]+)/,windows:/\b(Windows NT)/,macos:/\b(Mac OS)/,linux:/\b(Linux)/i},t=Object.keys(e).find((function(t){return e[t].test(navigator.userAgent)}));return t?q[t]:q.other},getX5Type:function(){var e,t=F.other;return 0<=navigator.userAgent.toLowerCase().indexOf("tbs")?null!=(e=navigator.userAgent.match(/tbs\/([\d.]+)/i))&&e[1]&&36541<=parseInt(e[1],10)?F.newX5:F.oldX5:t},refreshNetworkTypeToBean:function(e){var t=this,n=e.config;("function"==typeof n.getNetworkType?n.getNetworkType:te)((function(n){k[n]||(n=k.unknown),e.extendBean("netType",n),t.NetworkRefreshTimer=setTimeout((function(){t.refreshNetworkTypeToBean(e),clearTimeout(t.NetworkRefreshTimer)}),1e4)}))}}),te=function(e){var t="",n=navigator.userAgent.match(/NetType\/(\w+)/);n?t=n[1]:navigator.connection&&(t=navigator.connection.effectiveType||navigator.connection.type),e((t=t=t||"unknown",0<=(t=String(t).toLowerCase()).indexOf("4g")?k.net4g:0<=t.indexOf("wifi")?k.wifi:0<=t.indexOf("5g")?k.net5g:0<=t.indexOf("6g")?k.net6g:0<=t.indexOf("3g")?k.net3g:0<=t.indexOf("2g")?k.net2g:k.unknown))},ne=(new I({name:"onError"}),new I({name:"onError",init:function(){this.startListen()},startListen:function(){var e=this,t=window.onerror;window.onerror=function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];e.publishErrorLog({msg:(l(n[0])||"")+" @ ("+(l(n[1])||"")+":"+(n[2]||0)+":"+(n[3]||0)+")",level:p.ERROR}),null==t||t.call.apply(t,function(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var r=Array(e),o=0;for(t=0;t<n;t++)for(var i=arguments[t],s=0,a=i.length;s<a;s++,o++)r[o]=i[s];return r}([window],n))},window.addEventListener("unhandledrejection",(function(t){t=t&&l(t.reason),e.publishErrorLog({msg:"PROMISE_ERROR: "+t,level:p.PROMISE_ERROR})})),window.document.addEventListener("error",(function(t){if(t&&t.target&&t.srcElement){t=(n=t.target||t.srcElement).src||n.href;var n=n.tagName;if("string"==typeof t&&-1===(null==t?void 0:t.indexOf("aegis.qq.com"))&&n){var r={msg:n+" load fail: "+t,level:p.INFO};switch(n.toLowerCase()){case"script":r.level=p.SCRIPT_ERROR;break;case"link":r.level=p.CSS_ERROR;break;case"img":r.level=p.IMAGE_ERROR;break;case"audio":case"video":r.level=p.MEDIA_ERROR;break;default:return}e.publishErrorLog(r)}}}),!0);var n=this;_({send:function(e,t){e.addEventListener("loadend",(function(){var e="";this.aegisTimeout?e="timeout":this.status<=0?e="failed":400<=this.status&&(e="error"),e&&n.publishErrorLog({msg:"AJAX_ERROR: request "+e+". status: "+this.status+". \n \n                    url: "+this.aegisUrl+". \n \n                    method: "+this.aegisMethod+". \n\n                    request body: "+l(t)+".",level:p.AJAX_ERROR})})),e.addEventListener("timeout",(function(){e.aegisTimeout=!0}))}})},publishErrorLog:function(e){this.$walk((function(t){t.normalLogPipeline(e)}))}})),re=(new I({name:"pagePerformance"}),new I({name:"pagePerformance",onNewAegis:function(e){var t=this;if(c())if(Y)this.publish(Y,e);else try{this.getFirstScreenTiming(e,(function(n){var r,o=performance.timing;o&&(r=o.loadEventStart-o.domInteractive,Y={dnsLookup:o.domainLookupEnd-o.domainLookupStart,tcp:o.connectEnd-o.connectStart,ssl:0===o.secureConnectionStart?0:o.requestStart-o.secureConnectionStart,ttfb:o.responseStart-o.requestStart,contentDownload:o.responseEnd-o.responseStart,domParse:o.domInteractive-o.domLoading,resourceDownload:r=r<0?1070:r,firstScreenTiming:Math.floor(n)},t.publish(Y,e))}))}catch(e){}},publish:function(e,t){var n,r=[];for(n in e)r.push(n+"="+e[n]);var o=this.$getConfig(t),i=-1===t.config.performanceUrl.indexOf("?")?"?":"&";"function"==typeof o.urlHandler?t.send({url:t.config.performanceUrl+i+r.join("&")+"&from="+(encodeURIComponent(o.urlHandler())||window.location.href),beanFilter:["from"],type:f.PERFORMANCE}):t.send({url:t.config.performanceUrl+i+r.join("&"),type:f.PERFORMANCE})},getFirstScreenTiming:function(e,t){var n=["script","style","link","br"],r=[],o=this,i={},s=new MutationObserver((function(e){var t={roots:[],rootsDomNum:[],time:performance.now()};e.forEach((function(e){e&&e.addedNodes&&e.addedNodes.forEach&&e.addedNodes.forEach((function(e){1===e.nodeType&&(e.hasAttribute("AEGIS-FIRST-SCREEN-TIMING")||e.querySelector("[AEGIS-FIRST-SCREEN-TIMING]"))?(Object.prototype.hasOwnProperty.apply(i,[t.time])||(i[t.time]=[]),i[t.time].push(e)):1!==e.nodeType||-1!==n.indexOf(e.nodeName.toLocaleLowerCase())||o.isEleInArray(e,t.roots)||e.hasAttribute("AEGIS-IGNORE-FIRST-SCREEN-TIMING")||(t.roots.push(e),t.rootsDomNum.push(o.walkAndCount(e)||0))}))})),t.roots.length&&r.push(t)}));s.observe(document,{childList:!0,subtree:!0}),setTimeout((function(){s.disconnect();var n=0,a=0,c=!1,u=Object.keys(i).filter((function(e){return i[+e].find((function(e){return o.isInFirstScreen(e)}))}));u.length?(a=Math.max.apply(null,u),e.firstScreenInfo={element:null===(u=i[a])||void 0===u?void 0:u[0],timing:a,markDoms:i}):r.forEach((function(t){for(var r=0;r<t.roots.length;r++)t.rootsDomNum[r]>n&&o.isInFirstScreen(t.roots[r])&&(n=t.rootsDomNum[r],a=t.time,e.firstScreenInfo={element:t.roots[r],timing:a})}));for(var l,p=document.querySelectorAll(".fp-check"),f=[],d=0;d<p.length;d++)"img"===p[d].tagName.toLowerCase()&&""!==p[d].src?f.push(p[d].src):(l=window.getComputedStyle(p[d]),(l=/url\(['"](.+)['"]\)/gi.exec(l.backgroundImage))&&2===l.length&&f.push(l[1]));var m=0;window.performance.getEntriesByType("resource").some((function(e){return f.some((function(t,n){return t===e.name&&(e.responseEnd>m&&(m=e.responseEnd),(e.fetchStart<a||e.startTime<a)&&e.responseEnd>a&&(c=!0,a=e.responseEnd),f.splice(n,1),!0)})),0===f.length})),0===a&&(a=m),null==t||t(c?a:a+25)}),3e3)},isEleInArray:function(e,t){return!(!e||e===document.documentElement)&&(-1!==t.indexOf(e)||this.isEleInArray(e.parentElement,t))},isInFirstScreen:function(e){if(!e||"function"!=typeof e.getBoundingClientRect)return!1;var t=e.getBoundingClientRect(),n=window.innerHeight;return e=window.innerWidth,0<=t.left&&t.left<e&&0<=t.top&&t.top<n},walkAndCount:function(e){var t=0;if(e&&1===e.nodeType){t+=1;var n=e.children;if(null!=n&&n.length)for(var r=0;r<n.length;r++)t+=this.walkAndCount(n[r])}return t}})),oe=!1,ie=!1,se=(new I({name:"webVitals"}),new I({name:"webVitals",onNewAegis:function(e){if(c())try{!function(e,t){function n(e){var t=e.startTime;t<i.timeStamp?(o.value=t,o.entries.push(e)):o.isFinal=!0,r()}t=1<arguments.length&&void 0!==t&&t;var r,o=G("LCP"),i=J(),s=W("largest-contentful-paint",n);s&&(r=$(e,o,s,t),t=function(){o.isFinal||(s.takeRecords().map(n),o.isFinal=!0,r())},(Z=Z||new Promise((function(e){return["scroll","keydown","pointerdown"].map((function(t){addEventListener(t,e,{once:!0,passive:!0,capture:!0})}))}))).then(t),X(t,!0))}(this.publish.bind(this,e)),n=this.publish.bind(this,e),r=G("FID"),o=J(),i=W("first-input",t),s=$(n,r,i),i?X((function(){i.takeRecords().map(t),i.disconnect()}),!0):window.perfMetrics&&window.perfMetrics.onFirstInputDelay&&window.perfMetrics.onFirstInputDelay((function(e,t){t.timeStamp<o.timeStamp&&(r.value=e,r.isFinal=!0,r.entries=[{entryType:"first-input",name:t.type,target:t.target,cancelable:t.cancelable,startTime:t.timeStamp,processingStart:t.timeStamp+e}],s())})),function(e,t){function n(e){e.hadRecentInput||(o.value+=e.value,o.entries.push(e),r())}t=1<arguments.length&&void 0!==t&&t;var r,o=G("CLS",0),i=W("layout-shift",n);i&&(r=$(e,o,i,t),X((function(e){e=e.isUnloading,i.takeRecords().map(n),e&&(o.isFinal=!0),r()})))}(this.publish.bind(this,e))}catch(e){}function t(e){e.startTime<o.timeStamp&&(r.value=e.processingStart-e.startTime,r.entries.push(e),r.isFinal=!0,s())}var n,r,o,i,s},publish:function(e,t){var n,r=t.name,o=t.value,i={LCP:-1,FID:-1,CLS:-1},s=[];for(n in i)s.push(n+"="+(n===r?o:i[n]));var a=-1===e.config.performanceUrl.indexOf("?")?"?":"&";setTimeout((function(){e.send({url:e.config.webVitalsUrl+a+s.join("&"),type:f.VITALS})}),0)}})),ae=(new I({name:"tjg"}),!1),ce=new I({name:"tjg",onNewAegis:function(e){this.setTjgHeader(e)},setTjgHeader:function(e){ae||(ae=!0,this.overrideFetch(e),this.overrideXHR(e))},overrideFetch:function(e){var t=this;D({beforeFetch:function(n,r){t.isSameOrigin(n)&&(r.headers?r.headers instanceof Headers&&r.headers.append("X-Tjg-Json-Span-Context",t.getTjgHeaderValue(e)):r.headers=new Headers({"X-Tjg-Json-Span-Context":t.getTjgHeaderValue(e)}))}})},overrideXHR:function(e){var t=this;_({send:function(n,r){var o;t.isSameOrigin(n.aegisUrl)&&(o=t.getTjgHeaderValue(e),n.aegisTjgTrace=o,n.setRequestHeader("X-Tjg-Json-Span-Context",o))}})},getTjgHeaderValue:function(e){var t;return null===(t=window.btoa)||void 0===t?void 0:t.call(window,JSON.stringify({ids:{trace_id:{high:this.rand53(),low:this.rand53()},span_id:this.rand53(),parent_id:0,flag:2},baggages:{aegis_session_id:e.sessionID}}))},rand53:function(){return parseInt(new Array(53).fill(1).map((function(){return.5<Math.random()?1:0})).join(""),2)},isSameOrigin:function(e){var t=this,n=!1;if(this.$walk((function(e){!0===t.$getConfig(e).crossOrigin&&(n=!0)})),n)return!0;var r=document.createElement("a");return r.href=e,location.origin===r.origin}}),ue=function(e,t){var n,r={fetch:[],static:[]},o=new FormData;return Array.isArray(e)?e.forEach((function(e){var t=z(e);r[e.type].push(t)})):(n=z(e),r[e.type].push(n)),o.append("payload",JSON.stringify(j({duration:r},t))),o};Object.assign||Object.defineProperty(Object,"assign",{enumerable:!1,configurable:!0,writable:!0,value:function(e){if(null==e)throw new TypeError("Cannot convert first argument to object");for(var t=Object(e),n=1;n<arguments.length;n++)if(null!=(r=arguments[n]))for(var r=Object(r),o=Object.keys(Object(r)),i=0,s=o.length;i<s;i++){var a=o[i],c=Object.getOwnPropertyDescriptor(r,a);null!=c&&c.enumerable&&(t[a]=r[a])}return t}}),Array.prototype.find||Object.defineProperty(Array.prototype,"find",{configurable:!0,writable:!0,value:function(e){if(null===this)throw new TypeError('"this" is null or not defined');var t=Object(this),n=t.length>>>0;if("function"!=typeof e)throw new TypeError("predicate must be a function");for(var r=arguments[1],o=0;o<n;){var i=t[o];if(e.call(r,i,o,t))return i;o+=1}}});var le,pe,fe=0,de=(N(pe=ge,me=le=x),pe.prototype=null===me?Object.create(me):(he.prototype=me.prototype,new he),ge.prototype.getBean=function(e){var t=this;return void 0===e&&(e=[]),""+Object.getOwnPropertyNames(this.bean).filter((function(t){return-1===e.indexOf(t)})).map((function(e){return e+"="+t.bean[e]})).join("&")},ge.prototype.send=function(e,t,n){var r=this;if(e&&"string"==typeof e.url&&""!==e.url&&this.bean.id)if(this.requesting)this.requestQueue.push({options:e,success:t,fail:n});else{this.requesting=!0;var o=e.url;!1!==e.addBean&&(o=o+(-1===o.indexOf("?")?"?":"&")+this.getBean(e.beanFilter)),e.url=o;var i=e.method||"get";if(!(e=(o=this.config.onBeforeRequest)?o(e,this):e)||!e.url)return console.error("Please handle the parameters reasonably, options.url is necessary");var s=new XMLHttpRequest;s.sendByAegis=!0,s.addEventListener("readystatechange",(function(){var e;4===s.readyState&&(r.requesting=!1,(e=r.requestQueue.shift())&&r.send(e.options,e.success,e.fail),400<=s.status?null==n||n(s.response):null==t||t(s.response))})),"get"===i.toLocaleLowerCase()?(s.open("get",function(e,t){if("string"!=typeof e)return"";if("object"==typeof t&&t){var n=Object.getOwnPropertyNames(t).map((function(e){var n=t[e];return e+"="+("string"==typeof n?encodeURIComponent(n):encodeURIComponent(JSON.stringify(n)))})).join("&").replace(/eval/gi,"evaI");return e+(-1===e.indexOf("?")?"?":"&")+n}return e}(e.url,e.data)),s.send()):(s.open("post",e.url),e.contentType&&s.setRequestHeader("Content-Type",e.contentType),"string"==typeof e.data&&(e.data=e.data.replace(/eval/gi,"evaI")),s.send(e.data))}},ge.useAsyncPlugin=function(e,t){var n,r=void 0===(n=(t=void 0===t?{}:t).exportsConstructor)?"aegis-plugin-"+fe:n,o=void 0===(n=t.onAegisInit)?function(){}:n,i=void 0===(t=t.onAegisInitAndPluginLoaded)?function(){}:t;if(fe+=1,"string"!=typeof e)throw new TypeError("useAsyncPlugin first param must be string");if("function"!=typeof o||"function"!=typeof i)throw new TypeError("onAegisInit and onAegisInitAndPluginLoaded must be function");this.use(new I({name:"asyncPlugin",onNewAegis:function(t){try{o(t),ge.asyncPlugin[e]?i(t,window[ge.asyncPlugin[e]]):(n=e,s=r,a=function(n){n||(ge.asyncPlugin[e]=r,n=window[r],i(t,n))},c=document.createElement("script"),u=document.head,"function"==typeof s&&(a=s,s=""),c.src=n,c.setAttribute("name",s),c.name=s,c.setAttribute("crossorigin","anonymous"),c.crossorigin="anonymous",c.async=!0,c.hasLoaded=!1,c.onreadystatechange=function(){c.hasLoaded||c.readyState&&"loaded"!==c.readyState&&"complete"!==c.readyState||(c.hasLoaded=!0,"function"==typeof a&&a(!1),setTimeout((function(){u.contains(c)&&u.removeChild(c)})))},c.onload=c.onreadystatechange,c.onerror=function(){"function"==typeof a&&a(!0),setTimeout((function(){u.contains(c)&&u.removeChild(c)}))},u.appendChild(c))}catch(n){console.log("error on below is caused by "+e+" "),console.error(n)}var n,s,a,c,u}}))},ge.prototype.uploadLogs=function(e,t){this.lifeCycle.emit("uploadLogs",e=void 0===e?{}:e,t=void 0===t?{}:t)},ge.__version__="1.33.9",ge.sessionID="session-"+Date.now(),ge.asyncPlugin={},ge.urls={aegisCollect:"https://aegis.qq.com/collect",flog:"https://cdn-go.cn/vasdev/web_webpersistance_v2/latest/flog.core.min.js",shadowLog:""},ge),me=(new I({name:"offlineLog"}),x=new I({name:"offlineLog",onNewAegis:function(t){var n=de.urls.flog,r=t.config,o=[],i=null,s=null,a=function(e){s=e},c=function(e){o=o.concat(e)},u=function(e,t){i={conds:e=void 0===e?{}:e,params:t=void 0===t?{}:t}};de.useAsyncPlugin(n,{exportsConstructor:"Flog",onAegisInit:function(e){e.lifeCycle.on("beforeWrite",c),e.lifeCycle.on("uploadLogs",u),e.lifeCycle.on("onConfigChange",a)},onAegisInitAndPluginLoaded:function(t,n){var d=void 0===(g=r.dbConfig)?{}:g,m=void 0===(h=r.url)?de.urls.aegisCollect:h,g=void 0===(v=r.offlineLogExp)?3:v,h=r.id,v=r.uin;t.lifeCycle.remove("beforeWrite",c),t.lifeCycle.remove("uploadLogs",u),t.lifeCycle.remove("onConfigChange",a),d=Object.assign({lookupUrl:m+"/offlineAuto?id="+h,preservedDay:g,id:h,uin:v,aid:t.bean.aid||""},d,{sessionId:de.sessionID});try{var y=new n(d);o.forEach((function(e){y.add(j(j({},e),{level:p.INFO_ALL?p.INFO:e.level}))})),t.lifeCycle.on("beforeWrite",(function(e){(e=void 0===e?[]:e).forEach((function(e){y.add(j(j({},e),{level:p.INFO_ALL?p.INFO:e.level}))}))})),t.lifeCycle.on("uploadLogs",(function(e,n){void 0===e&&(e={}),void 0===n&&(n={}),y.uploadLogs(Object.assign({id:r.id,uin:r.uin,aid:t.bean.aid},e),n)})),t.lifeCycle.on("onConfigChange",(function(e){y.setConfig(e)})),y.on("PERREVENT",(function(n){t.send({type:f.OFFLINE,data:e({msg:l(n),level:p.INFO}),contentType:"application/x-www-form-urlencoded",method:"post",addBean:!1,url:r.url+"?id=893&sessionId="+de.sessionID+"&uin="+r.uin+"&from="+r.id+"&count=1&version=1.33.9"})})),s&&(y.setConfig(s),s=null),i&&(t.lifeCycle.emit("uploadLogs",i.conds,i.params),i=null),t.flog=y}catch(t){console.log(t)}}})}}),new I({name:"spa"}),new I({name:"spa",init:function(){history.pushState=this.wr("pushState")||history.pushState,history.replaceState=this.wr("replaceState")||history.replaceState;var e=(null===(e=location.href)||void 0===e?void 0:e.split("?"))[0];this.$fireUrl=e,this.sendPv=this.sendPv.bind(this),this.onPageChange()},onPageChange:function(){window.addEventListener("replaceState",this.sendPv),window.addEventListener("pushState",this.sendPv),window.addEventListener("popstate",this.sendPv)},wr:function(e){var t=history[e];return!("function"!=typeof t||!/native code/.test(t.toString()))&&function(){var n=t.apply(this,arguments),r=null;return"function"==typeof Event?r=new Event(e):(r=document.createEvent("HTMLEvents")).initEvent(e,!1,!0),window.dispatchEvent(r),n}},sendPv:function(){var e=this;setTimeout((function(){var t=location.href,n=(null===(n=location.href)||void 0===n?void 0:n.split("?"))[0];n&&n!==e.$fireUrl&&(e.$walk((function(e){e.send({url:e.config.pvUrl+"?from="+encodeURIComponent(t),beanFilter:["from"],type:f.WHITE_LIST})})),e.$fireUrl=n)}),0)}}));function ge(e){var t,n=le.call(this,e)||this;n.requestQueue=[],n.requesting=!1,n.speedLogPipeline=C([R(n.config),E(n.config),(t=n,function(e,n){te((function(r){t.extendBean("netType",r),n(e)}))}),function(e,t){n.lifeCycle.emit("beforeReportSpeed",e);var r=n.config.beforeReportSpeed;if((e="function"==typeof r?e.filter((function(e){var t=!1!==r(e);return"fetch"===e.type&&void 0===e.ret&&e.payload&&(e.ret=g(e.payload.data.response,n.config.api)),t})):e).length)return t(e)},function(e){n.send({type:f.SPEED,url:""+n.config.speedUrl,method:"post",data:ue(e,n.bean)})}]),e.asyncPlugin=!0;try{e.uin=e.uin||parseInt((document.cookie.match(/\buin=\D+(\d*)/)||[])[1],10)||parseInt((document.cookie.match(/\bilive_uin=\D*(\d+)/)||[])[1],10)||"",n.init(e),n.extendBean("sessionId",ge.sessionID),n.extendBean("from",encodeURIComponent(e.pageUrl||location.href)),n.extendBean("referer",encodeURIComponent(document.referrer||"")),e.ext1&&n.extendBean("ext1",e.ext1),e.ext2&&n.extendBean("ext2",e.ext2),e.ext3&&n.extendBean("ext3",e.ext3)}catch(e){console.warn(e),console.log("%c以上错误发生在初始化 Aegis 的过程中，将会影响您正常使用 Aegis，\n建议您联系 aegis-helper，进行反馈，感谢您的支持。","color: red"),n.sendSDKError(e)}return n}function he(){this.constructor=pe}return new I({name:"ie"}),de.use(ne),de.use(Q),de.use(L),de.use(re),de.use(se),de.use(T),de.use(ce),de.use(ee),de.use(x),de.use(me),de}()}(ve);var ye,we=ve.exports,be=function(){function e(e){void 0===e&&(e={}),this.userid=ee();var t=e.aegisOptions,n=pe(ae,void 0===t?{}:t,"onBeforeRequest");n.uin||(n.uin=this.userid),this.aegis=new we(n)}return e.prototype.setUid=function(e){this.aegis.setConfig({uin:e})},e.prototype.reportEvent=function(e,t){if(void 0===t&&(t={}),e&&"string"==typeof e){var n=e.replace(/\./g,"_"),r=Object.keys(t),o=r[0],i=r[1],s=r.slice(2),a=re(t,o),c=re(t,i),u=s.map((function(e){return re(t,e)})).filter((function(e){return e})).join("&");this.aegis.reportEvent({name:n,ext1:a,ext2:c,ext3:u})}},e.prototype.reportTime=function(e){if(void 0!==e.name&&void 0!==e.duration){var n=Math.min(6e4,Math.max(0,e.duration));this.aegis.reportTime(t(t({},e),{duration:n}))}},e.prototype.log=function(e){this.aegis.info(e)},e.prototype.error=function(e){this.aegis.error(e)},e.prototype.time=function(e){this.aegis.time(e)},e.prototype.timeEnd=function(e){this.aegis.timeEnd(e)},e}(),Oe=j.isBrowser&&window.weLibReportConfig||{},Ee=j.isBrowser?new be(Oe):null,Se=j.isBrowser?new he(Oe):null;j.isBrowser&&(void 0===(ye={statIframe:!0})&&(ye={}),ye.repeatApplay="true",ye.virtualDomain="wegamecn.qq.com",ye.virtualURL="/"+location.hostname+Z,Y((function(){"function"==typeof window.pgvMain&&window.pgvMain(ye)})));var Re=V;return e.Perf=be,e.Report=he,e.cgi={config:function(){},cgiInit:function(){}},e.emonitor={},e.emonitorIns={},e.init=function(e){var r=e.main||"",o=e.sub||"",i=e.gameId||e.game_id||0,s=e.qosId||8866,a=e.keys||[];return function(e,c,u){void 0===u&&(u={});var l={},p=[],f=!1;c=c||{},e=Array.isArray(e)?e:[e];for(var d=0;d<e.length;d++)if(e[d]||0===e[d]){var m=a[d]||"val"+d;"from"===(m="gameid"===m||"game_id"===m?"tgameid":m).toLowerCase()&&(f=!0),l[m]=e[d],p.push(e[d])}Object.keys(c).forEach((function(e){var t="gameid"===e||"game_id"===e?"tgameid":e;"from"===t.toLowerCase()&&(f=!0),l[t]=c[e]})),P.get("tgp_id")&&(l.tgpid=P.get("tgp_id")),P.get("tgp_user_type")&&(l.utype=P.get("tgp_user_type")),P.get("region")&&(l.region=P.get("region")),l.ctype=1;var g=j.isWeGame?1:0;if(l.isclient=g,!f){var h=window.location.search||"",v=N.parse(h,{ignoreQueryPrefix:!0}).from||"";("string"!=typeof v||v.match(/[^\dA-Za-z.\-_]/))&&(v="unsafe"),j.isWeGame&&!v&&(v="client.wegame"),l.from=v}if(U(s,i,r,o,l),function(e){var t={hottag:e,virtualDomain:"wegamecn.qq.com",virtualURL:"/"+location.hostname+Z};Y((function(){"function"==typeof window.pgvSendClick&&window.pgvSendClick(t)}))}([r.toUpperCase(),o.toUpperCase()].concat(p).join(".")),Se){var y="v0_"+r+"_"+o;l.tgpid,l.isclient,l.ctype,l.region;var w=l.from,b=n(l,["tgpid","isclient","ctype","region","from"]);Se.reportEvent(y,t(t({page:r+"_"+o},b),{efrom:w}),t({immediate:!0},u))}}},e.perf=Ee,e.performance=function(){},e.report=Se,e.setConfig=function(){},e.tcss={visited:function(){},clicked:function(){}},e.timing={reportSpeed:function(){}},e.tqos=Re,Object.defineProperty(e,"__esModule",{value:!0}),e}({});
